driver:
  name: vagrant
#  provider: lxc
  provider: libvirt

provisioner:
  name: salt_solo
  salt_install: bootstrap
  salt_bootstrap_url: https://bootstrap.saltstack.com
  salt_bootstrap_options: -x python3 -n stable
  salt_version: latest
  require_chef: false
  is_file_root: true
  salt_minion_config_template: .test/config/minion.erb
  salt_minion_config_dropin_files:
    - .local/pillar.conf
  salt_copy_filter:
    - config
    - extensions
    - requisites
    - util
    - .travis.yml
    - kitchen.yml
    - README.md
    - requisites.sh
    - setup.sh
    - setup_foreman.sh
    - setup_salt.sh
    - upload_templates.py
    - Vagrantfile
    - Vagrantfile.common

platforms:
  - name: debian
    lifecycle:
      pre_converge:
        - remote: 'echo "deb http://ftp.debian.org/debian stretch-backports main" | sudo tee /etc/apt/sources.list.d/backports.list'
        - remote: 'sudo apt-get update'
        - remote: 'sudo apt-get upgrade -y -o DPkg::Options::=--force-confold'
        - remote: 'sudo apt-get install -y ca-certificates wget host curl gnupg2 sudo apt-transport-https libffi-dev git python3-pip zlib1g-dev'
        - remote: 'sudo apt-get install -t stretch-backports -y libgit2-dev'
        - remote: 'sudo pip3 install --upgrade pyOpenSSL pygit2==0.27.3 docker-py cherrypy jinja2 Flask eventlet PyYAML flask-socketio requests_oauthlib google-auth'
    driver:
      box: "debian/stretch64"
    driver_config:
      run_command: /lib/systemd/systemd

suites:
  - name: default
