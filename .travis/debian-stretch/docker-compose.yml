version: '3.4'
services:
  master:
    image: salt_master
    build:
      context: .
      dockerfile: .travis/debian-stretch/master/Dockerfile
      args:
        hostname: master
        saltenv: dev
        pillarenv: orch
        salt_ver: "2017.7.3"
        log_level: "info"
    command: "2017.7.3"
    hostname: master
    domainname: local
    privileged: true
    ports:
     - "4505:4505"
     - "4506:4506"
    networks:
      local:
        aliases:
          - master.local
#      hostnet: {}
  minion1:
    image: salt_minion
    build:
      context: .
      dockerfile: .travis/debian-stretch/minion/Dockerfile
      args:
        salt_ver: "2017.7.3"
    command: "2017.7.3"
    hostname: minion1
    domainname: local
    privileged: true
    depends_on:
      - master
    networks:
      local:
        aliases:
          - minion1.local
  minion2:
    image: salt_minion
    build:
      context: .
      dockerfile: .travis/debian-stretch/minion/Dockerfile
      args:
        salt_ver: "2017.7.3"
    command: "2017.7.3"
    hostname: minion2
    domainname: local
    privileged: true
    depends_on:
      - master
    networks:
      local:
        aliases:
          - minion2.local
  minion3:
    image: salt_minion
    build:
      context: .
      dockerfile: .travis/debian-stretch/minion/Dockerfile
      args:
        salt_ver: "2017.7.3"
    command: "2017.7.3"
    hostname: minion3
    domainname: local
    privileged: true
    depends_on:
      - master
    networks:
      local:
        aliases:
          - minion3.local

networks:
  local:
    driver: bridge
#  hostnet:
#    external:
#      name: host
